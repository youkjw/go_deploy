import{H as d,d as x,k as z,J as I,o as U,c as j,b as r,w as n,e as t,C as c,N as T,i as p,t as g,f,aW as P,Q as R,l as V,z as b,O as D}from"./index.85d3582f.js";import{X as L}from"./PageHeader.556c52c2.js";import{u as B}from"./data-table.6c22a710.js";import{a as v,r as l,e as F}from"./render.edbb01fe.js";import{C as A}from"./CloseOutline.b801982a.js";import{N as E}from"./Select.60c05ccc.js";import{N as H}from"./DataTable.20b75ea0.js";import{N as O}from"./InputNumber.d1b1db42.js";import"./Anchor.d96a0ee7.js";import"./Tag.04c651c7.js";import"./Time.b1d0572f.js";import"./Popconfirm.ac7ac0d3.js";import"./ArrowDown.224587e2.js";import"./Checkbox.1898d3a6.js";import"./RadioGroup.5ac456f1.js";import"./Radio.10d2e386.js";import"./Remove.e20fb71e.js";import"./Add.32836a6c.js";class X{search(a){return d.get("/event/search",a)}prune(a){return d.post("/event/prune",{days:a})}}var y=new X;const oe=x({setup(k){const{t:a}=z(),i=I({type:void 0,name:""}),w=[{type:"group",label:"System",key:"system",children:[{label:"User",value:"User"},{label:"Role",value:"Role"},{label:"Chart",value:"Chart"},{label:"Setting",value:"Setting"}]},{type:"group",label:"Swarm",key:"swarm",children:[{label:"Registry",value:"Registry"},{label:"Node",value:"Node"},{label:"Network",value:"Network"},{label:"Service",value:"Service"},{label:"Stack",value:"Stack"},{label:"Secret",value:"Secret"},{label:"Config",value:"Config"}]},{type:"group",label:"Local",key:"local",children:[{label:"Image",value:"Image"},{label:"Container",value:"Container"},{label:"Volume",value:"Volume"}]}],N=[{title:a("fields.id"),key:"id",width:210,fixed:"left"},{title:a("fields.type"),key:"type",render(e){return v(e.type)}},{title:a("fields.action"),key:"action",render(e){return v(e.action)}},{title:a("fields.object"),key:"name",render:_},{title:a("fields.operator"),key:"name",render:e=>e.userId?l({name:"user_detail",params:{id:e.userId}},e.username):null},{title:a("fields.time"),key:"time",render:e=>F(e.time)}],{state:u,pagination:S,fetchData:m,changePageSize:C}=B(y.search,i);function _(e){switch(e.type){case"User":case"Role":case"Chart":case"Registry":case"Node":case"Config":case"Secret":return l({name:e.type.toLowerCase()+"_detail",params:{id:e.args.id}},e.args.name);case"Network":case"Service":case"Stack":return l({name:e.type.toLowerCase()+"_detail",params:{name:e.args.name}},e.args.name);case"Image":return e.args.id?l({name:"image_detail",params:{node:e.args.node||"-",id:e.args.id}},e.args.id.substring(7,19)):l({name:"image_list"},a("objects.image"));case"Container":return e.args.id?l({name:"container_detail",params:{node:e.args.node||"-",id:e.args.id}},e.args.name):l({name:"container_list"},a("objects.container"));case"Volume":return e.args.name?l({name:"volume_detail",params:{node:e.args.node||"-",name:e.args.name}},e.args.name):l({name:"volume_list"},a("objects.volume"));case"Setting":return l({name:"setting"},a("objects.setting"))}return null}function h(){const e=V(7);window.dialog.warning({title:a("dialogs.prune_event.title"),content:()=>b(D,{label:a("dialogs.prune_event.label"),labelPlacement:"top",showFeedback:!1},{default:()=>b(O,{min:0,defaultValue:e,style:"width: 100%"})}),positiveText:a("buttons.confirm"),negativeText:a("buttons.cancel"),onPositiveClick:async()=>{y.prune(e.value),window.message.success(a("texts.action_success")),m()}})}return(e,s)=>(U(),j(R,null,[r(L,null,{action:n(()=>[r(t(c),{secondary:"",size:"small",type:"warning",onClick:h},{icon:n(()=>[r(t(T),null,{default:n(()=>[r(t(A))]),_:1})]),default:n(()=>[p(" "+g(t(a)("buttons.prune")),1)]),_:1})]),_:1}),r(t(f),{class:"page-body",vertical:"",size:12},{default:n(()=>[r(t(f),{size:12},{default:n(()=>[r(t(E),{size:"small",placeholder:t(a)("fields.type"),value:t(i).type,"onUpdate:value":s[0]||(s[0]=o=>t(i).type=o),options:w,style:{width:"140px"},clearable:""},null,8,["placeholder","value"]),r(t(P),{size:"small",value:t(i).name,"onUpdate:value":s[1]||(s[1]=o=>t(i).name=o),placeholder:t(a)("fields.object"),clearable:""},null,8,["value","placeholder"]),r(t(c),{size:"small",type:"primary",onClick:s[2]||(s[2]=()=>t(m)())},{default:n(()=>[p(g(t(a)("buttons.search")),1)]),_:1})]),_:1}),r(t(H),{remote:"","row-key":o=>o.name,size:"small",columns:N,data:t(u).data,pagination:t(S),loading:t(u).loading,"onUpdate:page":t(m),onUpdatePageSize:t(C),"scroll-x":"max-content"},null,8,["row-key","data","pagination","loading","onUpdate:page","onUpdatePageSize"])]),_:1})],64))}});export{oe as default};
