import{d as h,k as C,J as S,l as T,m as U,o as f,c as B,b as i,w as l,e as t,C as g,N as P,i as v,t as y,f as b,a as D,g as I,aW as j,Q as A}from"./index.85d3582f.js";import{X as V}from"./PageHeader.556c52c2.js";import{c as p}from"./container.c3b8b557.js";import{n as X}from"./node.67b41fa8.js";import{u as E}from"./data-table.6c22a710.js";import{r as k,a as F,d as H,f as J}from"./render.edbb01fe.js";import{C as L}from"./CloseOutline.b801982a.js";import{N as M}from"./Select.60c05ccc.js";import{N as Q}from"./DataTable.20b75ea0.js";import"./Anchor.d96a0ee7.js";import"./Tag.04c651c7.js";import"./Time.b1d0572f.js";import"./Popconfirm.ac7ac0d3.js";import"./ArrowDown.224587e2.js";import"./Checkbox.1898d3a6.js";import"./RadioGroup.5ac456f1.js";import"./Radio.10d2e386.js";const de=h({setup(W){const{t:o}=C(),r=S({node:"",name:""}),m=T([]),w=[{title:o("fields.name"),key:"name",fixed:"left",render:e=>{var s;const a=(s=e.labels)==null?void 0:s.find(d=>d.name==="com.docker.swarm.node.id"),n=e.name.length>32?e.name.substring(0,32)+"...":e.name;return k({name:"container_detail",params:{id:e.id,node:(a==null?void 0:a.value)||"-"}},n)}},{title:o("objects.service"),key:"service",render:e=>{var n,s;const a=(s=(n=e.labels)==null?void 0:n.find(d=>d.name==="com.docker.swarm.service.name"))==null?void 0:s.value;return a?k({name:"service_detail",params:{name:a}},a):""}},{title:o("objects.image"),key:"image"},{title:o("fields.state"),key:"state",render(e){return F(e.state,e.state==="running"?"success":"error")}},{title:o("fields.created_at"),key:"createdAt"},{title:o("fields.actions"),key:"actions",render(e,a){return H("error",o("buttons.delete"),()=>N(e,a),o("prompts.delete"))}}],{state:u,pagination:_,fetchData:c,changePageSize:z}=E(p.search,r,!1);async function N(e,a){var s;const n=(s=e.labels)==null?void 0:s.find(d=>d.name==="com.docker.swarm.node.id");await p.delete((n==null?void 0:n.value)||"",e.id,e.name),u.data.splice(a,1)}async function x(){window.dialog.warning({title:o("dialogs.prune_container.title"),content:o("dialogs.prune_container.body"),positiveText:o("buttons.confirm"),negativeText:o("buttons.cancel"),onPositiveClick:async()=>{var a,n;const e=await p.prune(r.node);window.message.info(o("texts.prune_container_success",{count:(a=e.data)==null?void 0:a.count,size:J((n=e.data)==null?void 0:n.size)})),c()}})}return U(async()=>{var a,n;const e=await X.list(!0);m.value=(a=e.data)==null?void 0:a.map(s=>({label:s.name,value:s.id})),(n=e.data)!=null&&n.length&&(r.node=e.data[0].id),c()}),(e,a)=>(f(),B(A,null,[i(V,null,{action:l(()=>[i(t(g),{secondary:"",size:"small",type:"warning",onClick:x},{icon:l(()=>[i(t(P),null,{default:l(()=>[i(t(L))]),_:1})]),default:l(()=>[v(" "+y(t(o)("buttons.prune")),1)]),_:1})]),_:1}),i(t(b),{class:"page-body",vertical:"",size:12},{default:l(()=>[i(t(b),{size:12},{default:l(()=>[m.value&&m.value.length?(f(),D(t(M),{key:0,filterable:"",size:"small","consistent-menu-width":!1,placeholder:t(o)("objects.node"),value:t(r).node,"onUpdate:value":a[0]||(a[0]=n=>t(r).node=n),options:m.value,style:{width:"200px"}},null,8,["placeholder","value","options"])):I("",!0),i(t(j),{size:"small",value:t(r).name,"onUpdate:value":a[1]||(a[1]=n=>t(r).name=n),placeholder:t(o)("fields.name"),clearable:""},null,8,["value","placeholder"]),i(t(g),{size:"small",type:"primary",onClick:a[2]||(a[2]=()=>t(c)())},{default:l(()=>[v(y(t(o)("buttons.search")),1)]),_:1})]),_:1}),i(t(Q),{remote:"","row-key":n=>n.name,size:"small",columns:w,data:t(u).data,pagination:t(_),loading:t(u).loading,"onUpdate:page":t(c),onUpdatePageSize:t(z),"scroll-x":"max-content"},null,8,["row-key","data","pagination","loading","onUpdate:page","onUpdatePageSize"])]),_:1})],64))}});export{de as default};
