import{d as T,k as U,bW as V,l as x,bk as D,bm as E,m as M,o as i,c as m,b as a,w as l,e,C as p,N as w,i as f,t as d,bp as R,aW as g,Q as v,T as B,c2 as W,f as b,c3 as X,h as k,a as $}from"./index.85d3582f.js";import{X as j}from"./PageHeader.556c52c2.js";import{r as z}from"./role.e89e830c.js";import{p as I}from"./perm.097b4109.js";import{B as A}from"./ArrowBackCircleOutline.f4323d84.js";import{S as H}from"./SaveOutline.608b2aa9.js";import{a as L,N as O}from"./Grid.4637279d.js";import{N as y}from"./FormItemGridItem.2cbaea10.js";import{N as P,a as Q}from"./Checkbox.1898d3a6.js";import{N as J}from"./Table.e4fc5dbd.js";const K={width:"75",style:{"font-weight":"500"}},Y={width:"100"},de=T({setup(Z){const{t:o}=U(),G=V(),s=x({perms:[]}),F={name:D()},_=x(),{submit:S,submiting:N}=E(_,()=>z.save(s.value),()=>{window.message.info(o("texts.action_success")),X.push({name:"role_list"})});function h(r,n=!0){const t=I.find(u=>u.key===r);!t||t.actions.forEach(u=>{const c=t.key+"."+u;if(n)!s.value.perms.includes(c)&&s.value.perms.push(c);else{const C=s.value.perms.indexOf(c);C!==-1&&s.value.perms.splice(C,1)}})}async function q(){let r=G.params.id;if(r){let n=await z.find(r);s.value=n.data}}return M(q),(r,n)=>(i(),m(v,null,[a(j,{subtitle:s.value.name},{action:l(()=>[a(e(p),{secondary:"",size:"small",onClick:n[0]||(n[0]=t=>r.$router.push({name:"role_list"}))},{icon:l(()=>[a(e(w),null,{default:l(()=>[a(e(A))]),_:1})]),default:l(()=>[f(" "+d(e(o)("buttons.return")),1)]),_:1})]),_:1},8,["subtitle"]),a(e(b),{class:"page-body",vertical:"",size:12},{default:l(()=>[a(e(R),{model:s.value,rules:F,ref_key:"form",ref:_,"label-placement":"top"},{default:l(()=>[a(e(L),{cols:"1 640:2","x-gap":24},{default:l(()=>[a(e(y),{label:e(o)("fields.name"),path:"name"},{default:l(()=>[a(e(g),{placeholder:e(o)("fields.name"),value:s.value.name,"onUpdate:value":n[1]||(n[1]=t=>s.value.name=t)},null,8,["placeholder","value"])]),_:1},8,["label"]),a(e(y),{label:e(o)("fields.desc"),path:"desc",span:"2"},{default:l(()=>[a(e(g),{placeholder:e(o)("fields.desc"),value:s.value.desc,"onUpdate:value":n[2]||(n[2]=t=>s.value.desc=t)},null,8,["placeholder","value"])]),_:1},8,["label"]),a(e(y),{label:e(o)("fields.perms"),span:"2",path:"perms"},{default:l(()=>[a(e(P),{value:s.value.perms,"onUpdate:value":n[3]||(n[3]=t=>s.value.perms=t),style:{display:"contents"}},{default:l(()=>[a(e(J),{"single-line":!1,size:"small"},{default:l(()=>[(i(!0),m(v,null,B(e(I),t=>(i(),m("tr",null,[k("td",K,d(e(o)("objects."+t.key)),1),k("td",null,[a(e(b),{"item-style":"display: flex;"},{default:l(()=>[(i(!0),m(v,null,B(t.actions,u=>(i(),$(e(Q),{value:t.key+"."+u,label:e(o)("perms."+u)},null,8,["value","label"]))),256))]),_:2},1024)]),k("td",Y,[a(e(b),{size:4},{default:l(()=>[a(e(p),{quaternary:"",type:"info",size:"tiny",onClick:()=>h(t.key)},{default:l(()=>[f(d(e(o)("buttons.check")),1)]),_:2},1032,["onClick"]),a(e(p),{quaternary:"",type:"info",size:"tiny",onClick:()=>h(t.key,!1)},{default:l(()=>[f(d(e(o)("buttons.cancel")),1)]),_:2},1032,["onClick"])]),_:2},1024)])]))),256))]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),a(e(O),{span:2},{default:l(()=>[a(e(p),{disabled:e(N),loading:e(N),onClick:W(e(S),["prevent"]),type:"primary"},{icon:l(()=>[a(e(w),null,{default:l(()=>[a(e(H))]),_:1})]),default:l(()=>[f(" "+d(e(o)("buttons.save")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],64))}});export{de as default};
